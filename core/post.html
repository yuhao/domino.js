<script>
'use strict';

din.exportTo("post", function(){
  function predAdd(cond, log, key, value) {
    if (cond)
      log[key] = value;
  }

  function tryPost(cond, payload) {
    if (cond) {
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "http://146.6.28.88:3000/api/operation");
      xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
      xhr.send(JSON.stringify(payload));
      xhr.addEventListener("load", function() {
        predLog(true, "Sent");
      });

      var records = Object.keys(payload);
      for (var i = 0; i < records.length; i++) {
        delete payload[records[i]];
      }
    }
  }

  return {
    predAdd: predAdd,
    tryPost: tryPost
  }
});

</script>
